//-----------------------------------------------------------------------------//
// Import
//-----------------------------------------------------------------------------//

const _    = require('lodash');
const User = require('../model/user.js');

//-----------------------------------------------------------------------------//
// API Route
//-----------------------------------------------------------------------------//

const route = function(app){

    app.get('/api/rank', function (req, res) {


        Promise.all([
            User.countDocuments(),
            User.find()
                .select(['username', 'coin'])
                .limit(100)
                .sort({coin: -1})
                .lean()
        ]).then( ([ count, ranks ]) => {
            res.send({
                count: count,
                ranks: ranks
            });
        });
    });

}

//-----------------------------------------------------------------------------//
// Import
//-----------------------------------------------------------------------------//

module.exports = route;

//-----------------------------------------------------------------------------//